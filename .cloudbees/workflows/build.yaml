apiVersion: automation.cloudbees.io/v1alpha1
kind: workflow
name: Build E2E Tests Image
on:
  push:
    branches:
      - "**"
  workflow_dispatch:
permissions:
  scm-token-own: read
  scm-token-org: read
  id-token: write

jobs:
  build:
    uses: github.com/cb-squidstack/cb-squidstack/.cloudbees/workflows/build-generic.yaml@main
    with:
      app_name: squidstack-e2e-tests
      docker_user: ${{ vars.DOCKER_USER }}
      commit_sha: ${{ cloudbees.scm.sha }}
      push_latest: "true"
    secrets:
      docker_token: ${{ secrets.DOCKER_TOKEN }}
